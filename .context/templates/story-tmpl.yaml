template:
  id: story-template-v2
  name: 故事文档
  version: 2.0
  output:
    format: markdown
    filename: docs/stories/{{epic_num}}.{{story_num}}.{{story_title_short}}.md
    title: "故事 {{epic_num}}.{{story_num}}: {{story_title_short}}"

workflow:
  mode: interactive
  elicitation: advanced-elicitation

agent_config:
  editable_sections:
    - 状态
    - 故事
    - 验收标准
    - 任务/子任务
    - 开发备注
    - 测试
    - 变更日志

sections:
  - id: status
    title: 状态
    type: choice
    choices: [草稿, 已批准, 进行中, 审查, 完成]
    instruction: 选择故事的当前状态
    owner: master
    editors: [master, dev-agent]

  - id: story
    title: 故事
    type: template-text
    template: |
      **作为一个** {{role}},
      我想要{{action}},
      以便{{benefit}}
    instruction: 使用角色、行动和收益的标准格式定义用户故事
    elicit: true
    owner: master
    editors: [master]

  - id: acceptance-criteria
    title: 验收标准
    type: numbered-list
    instruction: 从PRD文件中复制编号的验收标准列表
    elicit: true
    owner: master
    editors: [master]

  - id: tasks-subtasks
    title: 任务/子任务
    type: bullet-list
    instruction: |
      将故事分解为实现所需的特定任务和子任务。
      在相关时引用适用的验收标准编号。
    template: |
      - [ ] 任务1 (验收标准: # 如果需要)
        - [ ] 子任务1.1...
      - [ ] 任务2 (验收标准: # 如果需要)
        - [ ] 子任务2.1...
      - [ ] 任务3 (验收标准: # 如果需要)
        - [ ] 子任务3.1...
    elicit: true
    owner: master
    editors: [master, dev-agent]

  - id: dev-notes
    title: 开发备注
    instruction: |
      填充来自docs文件夹实际工件的相关信息, 与本故事相关:
      - 不要编造信息
      - 如果已知, 添加与此故事相关的相关源代码树信息
      - 如果先前故事中有与此故事相关的要点, 请包含在内
      - 在此部分包含足够信息, 以便开发代理无需阅读架构文档, 这些备注连同任务和子任务必须为开发代理提供完成故事所需的所有上下文, 满足所有AC并完成所有任务+子任务, 且开销最小
    elicit: true
    owner: master
    editors: [master]
    sections:
      - id: testing-standards
        title: 测试
        instruction: |
          列出开发人员需要遵守的架构中相关的测试标准：
          - 测试文件位置
          - 测试标准
          - 使用的测试框架和模式
          - 本故事的任何特定测试要求
        elicit: true
        owner: master
        editors: [master]

  - id: change-log
    title: 变更日志
    type: table
    columns: [日期, 版本, 描述, 作者]
    instruction: 跟踪对此故事文档所做的更改
    owner: master
    editors: [master, dev-agent, qa-agent]

  - id: dev-agent-record
    title: 开发代理记录
    instruction: 此部分在实施期间由开发代理填充
    owner: dev-agent
    editors: [dev-agent]
    sections:
      - id: completion-notes
        title: 完成备注列表
        instruction: 关于任务完成情况和遇到问题的备注
        owner: dev-agent

      - id: file-list
        title: 文件列表
        instruction: 列出故事实施期间创建、修改或影响的所有文件
        owner: dev-agent

      - id: pending-clarification
        title: 待澄清需求
        instruction: 记录开发过程中需要进一步澄清的需求点
        owner: master




